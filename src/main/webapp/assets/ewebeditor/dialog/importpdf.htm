<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"> <html> <head> <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <script type="text/javascript" src="dialog.js"> </script> <script type="text/javascript"> document.write("<link href='../language/"+lang.bF+".css' type='text/css' rel='stylesheet'>");document.write("<link href='../skin/"+config.Skin+"/dialog.css' type='text/css' rel='stylesheet'>");var bm=lang["DlgPDF"];document.write("<title>"+bm+"</title>");var FE=(((config.SYWZFlag=="2"||config.SYTPFlag=="2")&&config.SYVLocal=="1")?true:false);function ok(){if(DLGRunOne.FH("btn_ok")){return;}DLGRunOne.BP("btn_ok",true);FT.wQ("isinstalled",[true],function(hT){if(!hT["Ret"]){Mh();return;}GQ();});};function GQ(){FT.wQ("getinfo",["pdfinstall","",""],function(hT){if(!hT["Ret"]){FT.jT(false);Mh();return;}if(hT["Ret"]!="yes"){FT.jT(false);Mh();ec.OpenDialog("installpdf.htm");return;}else{HN();}});};function HN(){var es=$("d_file").value;if(!iV(es,"pdf")){alert(lang["DlgPDFInvalidFile"]);Mh();return;}var eL=$("d_imgtype").options[$("d_imgtype").selectedIndex].value;var bu="";bu+="imgtype:"+eL+";";bu+="bl:"+$("d_bl").value+";";bB.Show();var GG=EWEB.SendUrl;if(FE){if($("d_syflag").checked){EWEB.SendUrl+="&syflag=1";if(!F.qJ){FT.kI.SendUrl=EWEB.SendUrl;}}}FT.wQ("execasync",["pdf2img",es,bu,""],function(hT){Io(hT,GG);});};function Io(hT,GG){if(GG!=EWEB.SendUrl){EWEB.SendUrl=GG;}if(hT["Error"]=="cancel"){parent.Cancel(true);return;}if(FT.Fi(hT["Error"])){Mh();return;}if(DLGRunOne.FH("btn_cancel")){parent.Cancel(true);return;}var ak="";var bC=hT["Body"];EWIN.addUploadFiles(hT["OriginalFiles"],hT["SavedFiles"]);if($("d_imgefflag").checked){bC='<div class="ewebeditor_doc" style="width:'+$('d_imgefwidth').value+';height:'+$('d_imgefheight').value+'; overflow:auto;background-color:#A0A0A3;border:1px solid #D4D0C8;text-align:center;">'+bC.replace(/(<img)(\s[^>]*?>)/gi,'$1 style="border-width:1px 2px 2px 1px;border-color:#00000;margin:5px;"$2')+'</div>';}if($("d_pos").checked){EWIN.setHTML(ak+bC,true);}else{EWIN.insertHTML(bC);if(ak){var fh=ak+EWIN.getHTML();EWIN.setHTML(fh,true);}}bB.Hide();parent.bV({flag:"AfterImportPDF",action:""});};function pf(bd,gK){pz(bd,gK,"INPUT");pz(bd,gK,"SPAN");};function pz(bd,gK,aH){var K=bd.getElementsByTagName(aH);for(var j=0;j<K.length;j++){K[j].disabled=gK;}};function pK(){var b=$("d_imgefflag").checked;pf($("group_imgef"),!b);};function LY(){var xk=$("d_bldrop").options[$("d_bldrop").selectedIndex].value;$("d_bl").value=xk;};function KX(){var bv=fk($("d_bl").value);var LB=$("d_bldrop");var qP=LB.options.length;for(var i=0;i<qP;i++){if(LB.options[i].value==bv){LB.selectedIndex=i;break;}}};function aq(){lang.ag(document);pK();parent.ar(bm);};function DO(){FT.wQ("isinstalled",[true],function(hT){if(!hT["Ret"]){return;}FT.wQ("dialogopen",[1,0,lang["DlgPDFFile"]+"(*.pdf)|*.pdf",1],function(hT){var es=hT["Ret"];if(es){$("d_file").value=es;}});});};function Lo(){if(DLGRunOne.FH("btn_ok")){if(DLGRunOne.FH("btn_cancel")){return;}DLGRunOne.BP("btn_cancel",true);bB.MZ(lang["MsgCancel"]);FT.wQ("cancel",[]);}else{parent.Cancel(true);}};function Mh(){bB.Hide();DLGRunOne.BP("btn_ok",false);if(DLGRunOne.FH("btn_cancel")){bB.Me(false);DLGRunOne.BP("btn_cancel",false);}} </script> </head> <body onload="aq()"> <table border=0 cellpadding=0 cellspacing=5 id=tabDialogSize><tr><td> <table border=0 cellpadding=0 cellspacing=0 align=center> <tr> <td> <fieldset> <legend><span lang=DlgPDFLegend></span>:</legend> <table border=0 cellpadding=5 cellspacing=0 width='100%'><tr><td> <table border=0 cellpadding=0 cellspacing=2 width='100%'> <tr> <td noWrap><span lang=DlgPDFFile></span>:</td> <td noWrap width='100%'><input type=text id='d_file' size=30 style='width:255px'> <input type=button class='dlgBtnCommon dlgBtn' lang=DlgBtnBrowse onclick='DO()'></td> </tr> </table> </td></tr></table> </fieldset> </td> </tr> <tr><td height=5></td></tr> <tr> <td> <fieldset> <legend><span lang=DlgPDFOptimize></span>:</legend> <table border=0 cellpadding=5 cellspacing=0 width="100%"> <tr><td valign=top> <table border=0 cellpadding=0 cellspacing=3> <tr> <td noWrap width="20%"><span lang=DlgWordImgType></span>:</td> <td noWrap width="29%"> <select id=d_imgtype size=1 style="width:80px"> <option value='jpg'>JPG</option> <option value='png' selected>PNG</option> </select> </td> <td width="2%">&nbsp;</td> <td noWrap width="20%"><span lang=DlgPDFBL></span>:</td> <td noWrap width="29%"> <div style="position:relative;"> <span style="margin-left:62px;width:18px;overflow:hidden;"> <select id=d_bldrop style="width:80px;margin-left:-62px" onchange="LY()"> <option value="50%">50%</option> <option value="60%">60%</option> <option value="70%">70%</option> <option value="80%">80%</option> <option value="90%">90%</option> <option value="100%" selected>100%</option> <option value="125%">125%</option> <option value="150%">150%</option> <option value="200%">200%</option> <option value="300%">300%</option> </select> </span> <input style="width:62px;position:absolute;left:0px;" id=d_bl size=10 value="100%" onchange="KX()"> </div> </td> </tr> <script type="text/javascript"> if(FE){document.write("<tr><td><span lang=DlgImgSYFlag></span>:</td><td colspan=4><input type=checkbox id=d_syflag value='1'></td></tr>");} </script> <tr><td colspan=5><input type=checkbox id=d_imgefflag value='1' onclick='pK()' checked><label for=d_imgefflag><span lang=DlgWordImgEfFlag></span>:</label> <span id=group_imgef><span lang=DlgWordImgEfWidth></span><input type=text size=5 id=d_imgefwidth style='width:50px' value='100%'>&nbsp;<span lang=DlgWordImgEfHeight></span><input type=text size=5 id=d_imgefheight style='width:50px' value=''></span></td></tr> </table> </td></tr> </table> </fieldset> </td> </tr> <tr><td height=5></td></tr> <tr> <td> <table border=0 cellpadding=0 cellspacing=0 width="100%"> <tr> <td noWrap><input type=checkbox id=d_pos checked><label for=d_pos><span lang=DlgComInsertReplace></span></label></td> <td noWrap align=right><input type=submit class="dlgBtnCommon dlgBtn" value="" id="btn_ok" onclick="ok()" lang=DlgBtnOK>&nbsp;&nbsp;<input type=button class="dlgBtnCommon dlgBtn" value="" id="btn_cancel" onclick="Lo()" lang=DlgBtnCancel> </tr> </table> </td> </tr> </table> </td></tr></table> <script type="text/javascript"> bB.OutHtml(lang["DlgPDFImporting"]); </script> </body> </html> 